{
	email admin@example.com
	# 启用通配符证书支持
	#    acme_ca https://acme-v02.api.letsencrypt.org/directory
	# 使用DNS挑战获取通配符证书
	# acme_dns <provider> <credentials>
	#    acme_dns alidns {
	#        access_key_id {env.ALIYUN_ACCESS_KEY_ID}
	#        access_key_secret {env.ALIYUN_ACCESS_KEY_SECRET}
	#    }
	#    tls {
	#        dns cloudflare {env.CF_API_TOKEN}
	#    }

	# 全局启用 CrowdSec Bouncer（镜像已预装，直接用）
	crowdsec_bouncer {
		api_url http://crowdsec:8080
		api_key a6F5e82zoV6tVueJo/m5mVxtbNgPKZ1cRQtyC2jvqO0
		action block # 恶意请求返回 403
		ticker_interval 5s # 5秒轮询一次黑名单
	}
	import snippets/global-log.conf
}

import templates/*
#import fpm-app fpm.{$SITE_ADDRESS} /var/www/lunchbox
import fpm-app-auth fpm.{$SITE_ADDRESS} /var/www/lunchbox
#import proxy-app octane.{$SITE_ADDRESS}  php-franken:8001
import proxy-octane-app-auth octane.{$SITE_ADDRESS} php-franken:8001

import proxy-app ws.{$SITE_ADDRESS} php-reverb:8080
import proxy-app mo.{$SITE_ADDRESS} minio:9001
import proxy-app mos.{$SITE_ADDRESS} minio:9000
import proxy-app mq.{$SITE_ADDRESS} rabbitmq:15672
import proxy-app push.{$SITE_ADDRESS} gotify:80
import proxy-app auth.{$SITE_ADDRESS} authelia:9091

import proxy-app-auth home.{$SITE_ADDRESS} homepage:3000
import proxy-app-auth search.{$SITE_ADDRESS} meilisearch:7700
import proxy-app-auth dozzle.{$SITE_ADDRESS} dozzle:8080

# import proxy-app ssh.{$SITE_ADDRESS}  ssh:8182
# import proxy-app app.{$SITE_ADDRESS}  chatNext:3000

app.{$SITE_ADDRESS}:45432 {
	reverse_proxy postgres:5432 {
		transport http {
			dial_timeout 5s
			response_header_timeout 30s
			read_timeout 30s
			write_timeout 30s
		}
	}
}

:46379 {
	reverse_proxy redis:6379
}

:45432 {
	reverse_proxy postgres:5432
}
