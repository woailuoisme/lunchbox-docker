(proxy-app-auth) {
	{args[0]} {
		# 启用访问日志
		import ../snippets/request-log.conf
		# apply security header
		import ../snippets/security.conf
		# Provide Zstd and Gzip compression
		encode zstd gzip
		forward_auth authelia:9091 {
			uri /api/authz/forward-auth
			copy_headers Remote-User Remote-Groups Remote-Email Remote-Name
		}
		reverse_proxy {args[1]} {
			header_up Cookie "authelia_session=[^;]+" "authelia_session=_"
			# 优化反向代理配置
			header_up X-Accel-Buffering "no"
			# 禁用响应缓冲，适用于流式响应
			flush_interval -1
			# 设置较长的超时时间 (适用于长连接，如 WebSocket)
			transport http {
				dial_timeout 10s
				response_header_timeout 30s
				read_timeout 1h
				write_timeout 1h
			}
		}
	}
}
