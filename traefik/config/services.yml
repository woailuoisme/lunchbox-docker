# Traefik 服务配置文件
# 适配 Traefik 3.5.4 - 本地和线上兼容版本

# TCP 服务配置（数据库服务）
tcp:
  services:
    # PostgreSQL 服务
    postgres:
      loadBalancer:
        servers:
          - address: "postgres:5432"

    # Redis 服务
    redis:
      loadBalancer:
        servers:
          - address: "redis:6379"

    # PgBouncer 服务
    pgbouncer:
      loadBalancer:
        servers:
          - address: "pgbouncer:6432"

# HTTP 服务配置
http:
  services:
    # Authelia 认证服务
    authelia:
      loadBalancer:
        servers:
          - url: "http://authelia:9091"
        passHostHeader: true
    # Nginx Web 服务器
    nginx:
      loadBalancer:
        servers:
          - url: "http://nginx:80"
        passHostHeader: true

    # Portainer 服务
    portainer:
      loadBalancer:
        servers:
          - url: "http://portainer:9000"
        passHostHeader: true

    # Dozzle 服务
    dozzle:
      loadBalancer:
        servers:
          - url: "http://dozzle:8080"
        passHostHeader: true

    # MeiliSearch 服务
    meilisearch:
      loadBalancer:
        servers:
          - url: "http://meilisearch:7700"
        passHostHeader: true

    # MinIO 服务
    minio:
      loadBalancer:
        servers:
          - url: "http://minio:9001"
        passHostHeader: true

    # 错误页面服务
    error-pages:
      loadBalancer:
        servers:
          - url: "http://error-pages:8080"
        passHostHeader: true

    # 容器注册表服务
    registry:
      loadBalancer:
        servers:
          - url: "http://registry:5000"
        passHostHeader: true

    # Watchtower 服务
    watchtower:
      loadBalancer:
        servers:
          - url: "http://watchtower:8080"
        passHostHeader: true
