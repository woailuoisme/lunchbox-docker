# 错误页面 Location 配置 - Server 块级别
# 此文件应该在每个 server {} 块中引入
# 配合 error-pages-global.conf 使用

# 代理到 error-pages 服务（容器名:端口）
location /error-pages/ {
    # 禁止缓存错误页面
    add_header Cache-Control "no-store, no-cache, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";

    # 转发到 error-pages 容器（Docker 网络内部访问）
    proxy_pass http://error-pages:8080/$status;  # error-pages 默认端口 8080
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    # 仅内部访问，禁止外部直接请求 /error-pages/ 路径
    internal;
}
