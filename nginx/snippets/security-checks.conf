# 安全检查配置 - 在 server 块中应用安全检测
# 此文件应该在 server 块中引入，配合 security-maps.conf 使用

# 1. 阻止恶意 User-Agent
location @block_bad_agent {
    access_log off;
    return 403 "Forbidden: Malicious User-Agent detected";
}

if ($bad_user_agent) {
    return 403;
}

# 2. 阻止 SQL 注入尝试
if ($bad_sql_injection) {
    return 403;
}

# 3. 阻止路径遍历攻击
if ($bad_path_traversal) {
    return 403;
}

# 4. 阻止无效的 HTTP 方法
if ($bad_method) {
    return 405;
}

# 注意：虽然在 nginx 中使用 if 指令通常不推荐，但在这种安全检查场景下
# 用于简单的返回操作是安全的，不会导致配置混乱
